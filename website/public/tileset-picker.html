<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tileset Coordinate Picker</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #4CAF50;
            text-align: center;
        }
        .controls {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .control-group {
            margin-bottom: 15px;
        }
        label {
            display: inline-block;
            width: 150px;
            color: #4CAF50;
        }
        input, select {
            background: #1a1a1a;
            border: 2px solid #4CAF50;
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }
        .canvas-container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
            position: relative;
        }
        canvas {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            border: 2px solid #4CAF50;
            cursor: crosshair;
            display: block;
        }
        .info {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .coordinate {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #4CAF50;
        }
        .coordinate-value {
            color: #4CAF50;
            font-weight: bold;
            font-size: 18px;
        }
        .grid-overlay {
            position: absolute;
            pointer-events: none;
            top: 20px;
            left: 20px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-right: 10px;
        }
        button:hover {
            background: #45a049;
        }
        .export-area {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 12px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Tileset Coordinate Picker</h1>
        
        <div class="controls">
            <div class="control-group">
                <label>Tile Size (px):</label>
                <input type="number" id="tileSize" value="16" min="1" max="64">
                <button onclick="redraw()">Update Grid</button>
            </div>
            <div class="control-group">
                <label>Zoom:</label>
                <input type="range" id="zoom" min="1" max="4" value="2" step="0.5">
                <span id="zoomValue">2x</span>
            </div>
            <div class="control-group">
                <label>Show Grid:</label>
                <input type="checkbox" id="showGrid" checked onchange="redraw()">
            </div>
            <div class="control-group">
                <label>Tile Type:</label>
                <select id="tileType">
                    <option value="GRASS">GRASS</option>
                    <option value="TREE">TREE</option>
                    <option value="DOOR">DOOR</option>
                    <option value="FLOWER">FLOWER</option>
                    <option value="PATH">PATH</option>
                    <option value="FENCE">FENCE</option>
                    <option value="SIGN">SIGN</option>
                    <option value="NPC">NPC</option>
                    <option value="WATER">WATER</option>
                    <option value="TALL_GRASS">TALL_GRASS</option>
                </select>
                <button onclick="saveTileCoordinate()">Save Coordinate</button>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="canvas"></canvas>
        </div>

        <div class="info">
            <h3>üìç Current Position</h3>
            <div class="coordinate">
                <strong>Hover Row:</strong> <span class="coordinate-value" id="currentRow">-</span><br>
                <strong>Hover Col:</strong> <span class="coordinate-value" id="currentCol">-</span>
            </div>

            <h3>üíæ Saved Coordinates</h3>
            <div id="savedCoordinates"></div>

            <h3>üìã Export for mapData.js</h3>
            <button onclick="exportCoordinates()">Generate Code</button>
            <pre class="export-area" id="exportCode">Click "Generate Code" to export...</pre>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        const savedTiles = {};

        let currentRow = -1;
        let currentCol = -1;

        img.onload = function() {
            redraw();
        };
        img.src = 'tileset.png';

        document.getElementById('zoom').addEventListener('input', function(e) {
            document.getElementById('zoomValue').textContent = e.target.value + 'x';
            redraw();
        });

        function redraw() {
            const tileSize = parseInt(document.getElementById('tileSize').value);
            const zoom = parseFloat(document.getElementById('zoom').value);
            const showGrid = document.getElementById('showGrid').checked;

            canvas.width = img.width * zoom;
            canvas.height = img.height * zoom;

            // Draw image
            ctx.imageSmoothingEnabled = false;
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

            // Draw grid
            if (showGrid) {
                ctx.strokeStyle = 'rgba(255, 0, 0, 0.5)';
                ctx.lineWidth = 1;

                const cols = Math.floor(img.width / tileSize);
                const rows = Math.floor(img.height / tileSize);

                for (let x = 0; x <= cols; x++) {
                    ctx.beginPath();
                    ctx.moveTo(x * tileSize * zoom, 0);
                    ctx.lineTo(x * tileSize * zoom, canvas.height);
                    ctx.stroke();
                }

                for (let y = 0; y <= rows; y++) {
                    ctx.beginPath();
                    ctx.moveTo(0, y * tileSize * zoom);
                    ctx.lineTo(canvas.width, y * tileSize * zoom);
                    ctx.stroke();
                }
            }

            // Highlight selected tiles
            for (const [type, coord] of Object.entries(savedTiles)) {
                ctx.strokeStyle = 'rgba(0, 255, 0, 0.8)';
                ctx.lineWidth = 3;
                ctx.strokeRect(
                    coord.col * tileSize * zoom,
                    coord.row * tileSize * zoom,
                    tileSize * zoom,
                    tileSize * zoom
                );
            }
        }

        canvas.addEventListener('mousemove', function(e) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const tileSize = parseInt(document.getElementById('tileSize').value);
            const zoom = parseFloat(document.getElementById('zoom').value);

            currentCol = Math.floor(x / (tileSize * zoom));
            currentRow = Math.floor(y / (tileSize * zoom));

            document.getElementById('currentRow').textContent = currentRow;
            document.getElementById('currentCol').textContent = currentCol;

            redraw();

            // Highlight current tile
            ctx.strokeStyle = 'rgba(255, 255, 0, 0.8)';
            ctx.lineWidth = 2;
            ctx.strokeRect(
                currentCol * tileSize * zoom,
                currentRow * tileSize * zoom,
                tileSize * zoom,
                tileSize * zoom
            );
        });

        canvas.addEventListener('click', function() {
            saveTileCoordinate();
        });

        function saveTileCoordinate() {
            const tileType = document.getElementById('tileType').value;
            if (currentRow >= 0 && currentCol >= 0) {
                savedTiles[tileType] = { row: currentRow, col: currentCol };
                updateSavedDisplay();
                redraw();
            }
        }

        function updateSavedDisplay() {
            const container = document.getElementById('savedCoordinates');
            container.innerHTML = '';
            
            for (const [type, coord] of Object.entries(savedTiles)) {
                const div = document.createElement('div');
                div.className = 'coordinate';
                div.innerHTML = `<strong>${type}:</strong> <span class="coordinate-value">{ row: ${coord.row}, col: ${coord.col} }</span>`;
                container.appendChild(div);
            }
        }

        function exportCoordinates() {
            let code = 'export const TILE_SPRITES = {\n';
            
            for (const [type, coord] of Object.entries(savedTiles)) {
                code += `  [TILE_TYPES.${type}]: { row: ${coord.row}, col: ${coord.col} },\n`;
            }
            
            code += '};';
            
            document.getElementById('exportCode').textContent = code;
        }
    </script>
</body>
</html>

